<!-- 850*360 -->
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>XGROUP</title>
    <link rel="stylesheet" type="text/css" href="function/code-inner.css">
    <link rel="stylesheet" type="text/css" href="function/macros.css">
    <style>
        .tab4 {
            tab-size: 8;
        }
    </style>
</head>

<body>
    <h1>XGROUP function
         <a href="interface.html"><button class="button button4" style="float: right;"><b>Download</b></button></a>
    </h1>

    <p>
    <div>● Mở rộng chức năng của siêu hàm GROUP. (hỗ trợ các hàm nâng cao) </div>
    <div>● Một trong những hàm kinh điển của Addins để tạo báo cáo thống kê chính xác, nhanh chóng và dễ tùy biến. </div>
    </p>
    

    <p>
        <hr style="height:1px;border-width:0;color:lightgray;background-color:lightgray">
    </p>
    <blockquote>
        <p>&nbsp;VD1: Thống kê số loại mặt hàng mua bởi mỗi khách hàng theo từng tháng.</p>
    </blockquote>
    <img src="gif/xgroup.gif">

    <p>
        <hr style="height:1px;border-width:0;color:lightgray;background-color:lightgray">
    </p>
    <blockquote>
        <p>&nbsp;VD2: Tính tổng số lượng nhập, xuất theo từng mã hàng.</p>
    </blockquote>
    <img src="gif/xgroup-sum.gif">

    <p>
        <hr style="height:1px;border-width:0;color:lightgray;background-color:lightgray">
    </p>
    <blockquote>
        <p>&nbsp;VD3: Đếm tổng số lượt ăn của mỗi nhân viên dựa trên mỗi khung giờ.</p>
    </blockquote>
    <img src="gif/xgroup-counta.gif">

    <blockquote>
        <p>&nbsp;VD4: Tính toán số lượng nguyên liệu tồn kho với XGROUP.</p>
        <p>&nbsp;Bài toán này có cùng kết quả khi sử dụng hàm <a href="query.html"
            style="color:#ea0606;text-decoration:underline">QUERY</a>.</p>
        <p>&nbsp;Để hiểu tại sao sử dụng SUM(PRODUCT(C3,C4)) bạn đọc xem ví dụ mẫu /Query - Tồnkho.xlsx(Dropbox)</p>
    </blockquote>
    <img src="gif/xgroup-tonkho.png">
    <code class="language-xls" style="word-spacing: -3px;"><span class="token operator">=</span><a class="token function" href="/xgroup">XGROUP.\AU</a><span class="token punctuation">(</span><a class="token function" href="https://exceljet.net/functions/drop-function">DROP</a><span class="token punctuation">(</span><a class="token function" href="/leftjoin">LEFTJOIN.\AU</a><span class="token punctuation">(</span><a class="token function" href="/unpivot">UNPIVOT.\AU</a><span class="token punctuation">(</span><span class="token range selector">A1:E5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"N"</span><span class="token punctuation">,</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token range selector">A9:B14</span><span class="token punctuation">,</span><span class="token brace">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token brace">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"SUM(PRODUCT(C3,C4))"</span><span class="token punctuation">)</span></code>

    <p tabindex="-1" dir="auto">
        <note>
           <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16"
              aria-hidden="true">
              <path
                 d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z">
              </path>
           </svg>
           <font style="vertical-align: inherit;">Cú pháp:</font>
        </note>
     </p>
     <blockquote>
      <p style="white-space: pre-line"><img src="gif/xgroup.syntax.png"><!--
        =XGROUP.\AU(array, [has_header], colsgroup_index, [variables], [col_1], [expr_1],..)
        - array             : mảng tham chiếu.
        - has_header        : chỉ rõ vùng chứa header hoặc không?.
        - colsgroup_index   : danh sách vị trí cột phân nhóm.
        - variables         : khai báo các biến phụ thuộc.
        - col_1             : vị trí cột cần tính toán.
        - expr_2            : công thức tùy chỉnh áp dụng cho cột đó (hỗ trợ các hàm tùy chỉnh nâng cao - xem danh sách phía dưới). -->
      </p>
    </blockquote>

    <p tabindex="-1" dir="auto">
        <note>
           <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16"
              aria-hidden="true">
              <path
                 d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z">
              </path>
           </svg>
           <font style="vertical-align: inherit;">Chú ý:</font>
        </note>
     </p>
     <blockquote>
        <p style="white-space: pre-line">- Nếu sử dụng biến phụ, cần khai báo các biến lần lượt theo thứ tự từ trái sang phải (vd: v3=v1+v2 thì cần khai báo các biến v1,v2 trước v3).
          - Danh sách biến [variables] có thể khai báo dạng mảng ({"v1=c1","v2=2*c2","v3=v1+v2"} hoặc chuỗi "v1=c1;v2=2*c2;v3=v1+v2").
          - Tham chiếu c1, c2, c3,.. là tên cột dữ liệu.
          - Mỗi một funcname ứng với một biểu thức tính toán duy nhất (vd: INDEX(c2,2) hoặc đặt ẩn phụ v1=INDEX(c2,2)).
          - Hàm được sử dụng khi việc tính toán có mối liên hệ giữa các cột, vì vậy yêu cầu cú pháp chặt chẽ so với hàm GROUP.
          - Hỗ trợ nhiều hàm nâng cao hơn so với hàm GROUP.
          - Để hiểu cách sử dụng hàm xem thêm các file ví dụ mẫu .xlsx từ DROPBOX.
        </p>
      </blockquote>
      <p>
        <hr style="height:1px;border-width:0;color:lightgray;background-color:lightgray">
      </p>
      <blockquote>
        <p>&nbsp;VD4: Tìm giao dịch cuối cùng của mỗi shop dựa vào mốc thời gian tại cột C.</p>
    </blockquote>
    <img src="gif/xgroup.variable.png">

    <blockquote>
    <p style="white-space: pre-line">Giải thích cách hoạt động:
        &nbsp;Hàm sẽ phân nhóm theo cột 1 và tiến hành tính toán lên cột 2,3.
        &nbsp;Tại cột 2: hàm sẽ tìm giá trị lớn nhất (ngày cuối cùng) của từng nhóm với giá trị đại diện là v1 (chẳng hạn Shop 1 ngày cuối cùng là 1/3/2023).
        &nbsp;Tại cột 3: hàm ROW(V1) trả về vị trí dòng giá trị này, INDEX(c3,ROW(v1)) trả về giá trị tại cột 3 ứng với dòng vừa tìm được (=7).
    </p>
    </blockquote>
     <p tabindex="-1" dir="auto">
        <note>
           <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16"
              aria-hidden="true">
              <path
                 d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z">
              </path>
           </svg>
           <font style="vertical-align: inherit;">Support functions:</font>
        </note>
     </p>
    <blockquote>
        <p ><img src="gif/support.xgroup.png">
            <!--
            - SUM                                               [vd: sum(c1,2,3)]
            - MEDIAN                                            [vd: median(c1,2,3)]
            - MAX/MIN/AVERAGE                                   [vd: max(c1,c2,c5)]
            - PRODUCT/DIVIDE                                    [vd: product(c1,c5) thay vì c1*c5]
            - CELL                                              [vd: cell(c1) tương ứng index(c1,1)]
            - COUNT/COUNTA/COUNTNIL/COUNTBLANK                  [áp dụng đếm số/đếm không trống/đếm trống/đếm trống và chuỗi trống]
            - COUNTUNIQUE                                       [vd: countunique(c1) đếm số giá trị duy nhất trên cột c1]
            - COUNTUNIQUEROWS                                   [vd: countuniquerows(c1) đếm hàng duy nhất trong chính phân nhóm đó]
            - MAXIF/MINIF/COUNTIF/SUMIF/AVERAGEIF/PRODUCTIF     [vd: maxif(c1,'>5') hoặc maxif(c1,'>0',c2)]
            - ROW                                               [vd: v=max(c1), r=row(v) chỉ áp dụng với các biến tồn tại thuộc tính ROW như max,min,first,last]
            - INDEX/MATCH                                       [vd: index(c1,[num]), match('a',c2,0) - tham số [num] >=0 (tìm trên xuống) hoặc <=0 (tìm dưới lên)
            - FIRST/LAST                                        [vd: first(c1,[ignore_empty])] hoặc last(c1) -tham số [ignore_empty] bỏ qua giá trị rỗng
            - TAKE/DROP                                         [vd: take(c1,[num]) hoặc drop(c1,[num])] - tham số [num] >=0 (lấy trên xuống) hoặc <0 (lấy từ cuối).
            - UNIQUE/SORT                                       [vd: unique(c1), sort(c1,[sort_order]) -tham số [sort_order] sắp xếp >=0 (tăng dần) <=0 (giảm dần)
            - LEN                                               [vd: len(c1)]
            - JOIN/JOINIF                                       [vd: join(',',[ignore_empty],c1) hoặc joinif(',',[ignore_empty],'>5',c1)]
            - MID/LEFT/RIGHT/TEXTBEFORE/TEXTAFTER               [vd: textbefore(c1,'abc')]
            - TRIM/REPLACE/QUOTE                                [vd: replace(c1,'a','b') hoặc quote(c1)]
            - UPPER/LOWER/PROPER/SENTENCE                       [vd: upper(c1)]
            - ABS/ROUND/ROUNDUP/ROUNDDOWN/CEILING               [vd: round(c1,2) làm tròn 2 chữ số thập phân]
            - DAY/MONTH/YEAR                                    [vd: day(c1) trả về ngày (1-31)hoặc month(c1) trả về tháng(1-12)] 
            - HOUR/MINUTE/SECOND                                [vd: hour(c1) trả về giờ (0-23h)hoặc MINUTE(c1) trả về phút(0-59p)] 
        -->
        </p>
    </blockquote>
    <p><strong>Related function</strong></p>

    <p>
        <a href="group.html">GROUP</a>&nbsp;&nbsp;&nbsp;Phân nhóm bảng dữ liệu dựa trên trường (cột) chỉ định. (hỗ trợ
        các hàm nâng cao).
    </p>
    <p>
        <a href="groupby.html">GROUPBY</a>
        &nbsp;&nbsp;&nbsp;Phân nhóm bảng dữ liệu dựa trên một mảng dữ liệu chỉ định, hỗ trợ tính toán tùy chỉnh.
      </p>
    <p>
        <a href="xgroupby.html">XGROUPBY</a>&nbsp;&nbsp;&nbsp;Hàm mở rộng của GROUPBY. (hỗ trợ các hàm nâng cao).
    </p>
    <p>Return to <a href="index.function.html">Home</a></p>

</body>

</html>